_config:
  _metadata:
    name: plugin-center-admin
    namespace: default
    template:
      type: template.caicloud.io/application
      version: 1.0.0
    version: "v0.1.7"
  controllers:
  - containers:
    - args:
      - --mongo-host=[[ platform_mongo_host ]]
      image: '[[ registry_release ]]/plugin-center-admin:v0.1.7'
      imagePullPolicy: IfNotPresent
      resources:
        limits:
          cpu: 300m
          memory: 300Mi
        requests:
          cpu: 200m
          memory: 200Mi
      env:
      - name: SERVER_PRELOAD_PATH
        value: /data/preload
      mounts:
      - name: preload
        path: /data
    initContainers:
    - env:
      - name: OUTPUT_DIR
        value: /data/preload
      - name: IMAGE_DOMAIN_PROJECT
        value: '[[ registry_release ]]'
      mounts:
      - name: preload
        path: /data
      image: '[[ registry_release ]]/compass-plugins-manifest:v0.1.0.alpha.0'
      imagePullPolicy: IfNotPresent
    controller:
      replica: 1
    services:
    - name: plugin-center
      ports:
      - port: 8080
        protocol: TCP
        targetPort: 8080
      type: ClusterIP
    type: Deployment
    volumes:
    - name: preload
      type: Scratch
      source:
        medium: ""
