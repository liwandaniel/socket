_config:
  _metadata:
    description: monitoring-metrics-server
    name: monitoring-metrics-server
    namespace: kube-system
    template:
      type: template.caicloud.io/application
      version: 1.0.0
    version: "v0.1.3-alpha.0"
  controllers:
  - containers:
    - image: '[[ registry_release ]]/caicloud-metrics-server:v0.1.3-alpha.0'
      imagePullPolicy: IfNotPresent
      command:
      - /metrics
      args:
      - --secure-port=8080
      - --kubelet-certificate-authority=/certs/ca
      - --kubelet-client-certificate=/certs/cert
      - --kubelet-client-key=/certs/key
      - -v4
      mounts:
      - name: certs
        path: /certs
    controller:
      replica: 3
      strategy:
        surge: 1
        unavailable: 1
    services:
    - name: caicloud-metrics-server
      ports:
      - port: 443
        protocol: TCP
        targetPort: 8080
      type: ClusterIP
    type: Deployment
    volumes:
    - name: certs
      type: Secret
      source:
        target: kubelet-client-tls-secret
