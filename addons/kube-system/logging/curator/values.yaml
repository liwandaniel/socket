_config:
  _metadata:
    description: curator-v1.0.0
    name: curator
    template:
      type: template.caicloud.io/application
      version: 1.0.0
    version: "v1.0.0"
  controllers:
  - containers:
    - command:
      - --config
      - /etc/config/config.yml
      - /etc/config/action_file.yml
      image: '[[ registry_release ]]/curator:v1.0.0'
      imagePullPolicy: IfNotPresent
      mounts:
      - name: curator-config
        path: /etc/config
    controller:
      rule: 1 0 * * *
    pod:
      restart: OnFailure
    type: CronJob
    volumes:
    - name: curator-config
      source:
        items:
        - key: action_file.yml
          path: action_file.yml
        - key: config.yml
          path: config.yml
        target: curator-config
      type: Config
    configs:
    - name: curator-config
      data:
      - key: action_file.yml
        value: |-
            ---
            # Remember, leave a key empty if there is no value.  None will be a string,
            # not a Python "NoneType"
            #
            # Also remember that all examples have 'disable_action' set to True.  If you
            # want to use this action as a template, be sure to set this to False after
            # copying it.
            actions:
              1:
                action: delete_indices
                description: "Clean up ES by deleting old indices"
                options:
                  timeout_override:
                  continue_if_exception: False
                  disable_action: False
                  ignore_empty_list: True
                filters:
                - filtertype: age
                  source: name
                  direction: older
                  timestring: '%Y.%m.%d'
                  unit: days
                  unit_count: 7
                  field:
                  stats_result:
                  epoch:
                  exclude: False
      - key: config.yml
        value: |-
            ---
            # Remember, leave a key empty if there is no value.  None will be a string,
            # not a Python "NoneType"
            client:
              hosts:
                - elasticsearch
              port: 9200
              url_prefix:
              use_ssl: False
              certificate:
              client_cert:
              client_key:
              ssl_no_validate: False
              http_auth:
              timeout: 30
              master_only: False

            logging:
              loglevel: INFO
              logfile:
              logformat: default
              blacklist: ['elasticsearch', 'urllib3']
     
